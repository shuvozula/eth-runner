<source>
  @type tail
  path /var/log/nvidia_miner.log
  tag hashrate.nvidia
  <parse>
    @type regexp
    expression /^\e\[\d+m\sm\s\e\[\d+m(?<hashtime>\d{2}:\d{2}:\d{2})\s\e\[\d+methminer\s\e\[\d+mSpeed\s\e\[\d+\;\d+m(?<total_hash_rate>\d{3}\.\d{2})\e\[\d+m\sMh/s\s(?<gpu0>gpu\d)\s\e\[\d+m(?<hashrate0>\d{1,2}\.\d{2})\e\[\d+m\s(?<gpu1>gpu\d)\s\e\[\d+m(?<hashrate1>\d{1,2}\.\d{2})\e\[\d+m\s(?<gpu2>gpu\d)\s\e\[\d+m(?<hashrate2>\d{1,2}\.\d{2})\e\[\d+m\s(?<gpu3>gpu\d)\s\e\[\d+m(?<hashrate3>\d{1,2}\.\d{2})\e\[\d+m\s(?<gpu4>gpu\d)\s\e\[\d+m(?<hashrate4>\d{1,2}\.\d{2})\e\[\d+m\s(?<gpu5>gpu\d)\s\e\[\d+m(?<hashrate5>\d{1,2}\.\d{2})\e\[\d+m\s(?<gpu6>gpu\d)\s\e\[\d+m(?<hashrate6>\d{1,2}\.\d{2})\e\[\d+m\s(?<gpu7>gpu\d)\s\e\[\d+m(?<hashrate7>\d{1,2}\.\d{2})\e\[\d+m/
    time_key hashtime
  </parse>
</source>

<source>
  @type tail
  path /var/log/ati_miner.log
  tag hashrate.amd
  <parse>
    @type regexp
    expression /^\e\[\d+m\sm\s\e\[\d+m(?<hashtime>\d{2}:\d{2}:\d{2})\s\e\[\d+methminer\s\e\[\d+mSpeed\s\e\[\d+\;\d+m(?<total_hash_rate>\d{3}\.\d{2})\e\[\d+m\sMh/s\s(?<gpu0>gpu\d)\s\e\[\d+m(?<hashrate0>\d{1,2}\.\d{2})\e\[\d+m\s(?<gpu1>gpu\d)\s\e\[\d+m(?<hashrate1>\d{1,2}\.\d{2})\e\[\d+m\s(?<gpu2>gpu\d)\s\e\[\d+m(?<hashrate2>\d{1,2}\.\d{2})\e\[\d+m\s(?<gpu3>gpu\d)\s\e\[\d+m(?<hashrate3>\d{1,2}\.\d{2})/
    time_key hashtime
  </parse>
</source>

<match hashrate.nvidia hashrate.amd>
  @type influxdb
  host 10.0.0.11
  port  8086
  dbname ethmetrics
  user  telegraf
  password  telegraf
  use_ssl false
  time_precision s
  tag_keys ["hashrate.nvidia", "hashrate.amd"]
  sequence_tag _seq
</match>
